<!DOCTYPE html>
<html lang="th">
<head>
  <title>Mechatronics and Robotics</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link href="public/MechaLogo.png" rel="icon" />
  <link href="https://fonts.googleapis.com/css2?family=Prompt:wght@400;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="receive.css">
  <link rel="stylesheet" href="style.css">
</head>
<body>
<div class="header">
    <img class="headerlogo" src="public/MechaLogo.png" alt="Logo">
</div>
<div class="maincontainer">
  <div class="mainboxserve">
  <div class="box">
    <div class="table">Table</div>
    <div class="table-number" id="tableNumber">-</div>
    <div class="info" id="buttonInfo"></div>
  </div>
</div>
<div class="mainboxserve">
  <div class="box">
    <div class="countdown" id="countdown">60</div>
    <div class="button-box">
    <button class="ok-btn" id="okBtn">รับอาหาร</button>
    <button class="AI-btn" id="AiBtn">AI</button>
    </div>
  </div>
</div>

<script>
const params = new URLSearchParams(window.location.search);
const table = params.get("table");          // ตัวอย่าง: "12"
const buttonsStr = params.get("buttons");   // ตัวอย่าง: "btn1,btn2"
let queue = JSON.parse(decodeURIComponent(params.get("queue"))); // รายการที่เหลือ

const buttons = buttonsStr.split(",");
const locations = buttons.map(btn => {
  switch(btn){
    case "btn1": return "ที่วางแก้วด้านซ้าย";
    case "btn2": return "ที่วางแก้วด้านขวา";
    case "btn3": return "ถาดที่1";
  }
});

document.getElementById("tableNumber").textContent = table;
document.getElementById("buttonInfo").textContent = locations.join(" , ");

let timeLeft = 60;
const countdownEl = document.getElementById("countdown");

const timer = setInterval(()=>{
  timeLeft--;
  countdownEl.textContent = timeLeft;
  if(timeLeft <=0){
    clearInterval(timer);
    countdownEl.textContent = "เสร็จสิ้น";
    setTimeout(goNext,1000);
  }
},1000);

function goNext(){
  if(queue.length > 0){
    window.location.href = `loading.html?queue=${encodeURIComponent(JSON.stringify(queue))}`;
  } else {
    window.location.href = "index.html";
  }
}

document.getElementById("okBtn").addEventListener("click", goNext);
</script>
</body>
</html>
